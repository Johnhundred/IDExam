jQuery("document").ready(function(){function e(){I=JSON.parse(localStorage.sAdmins)}function t(e){return I=JSON.parse(localStorage.sAdmins),I.admins.push(e),localStorage.sAdmins=JSON.stringify(I),!0}function n(e){I=JSON.parse(localStorage.sAdmins);for(var t=I.admins.length,n=0;n<t;n++)I.admins[n].id==e.id&&(I.admins[n]=e);return localStorage.sAdmins=JSON.stringify(I),!0}function a(t){e();for(var n=I.admins.length,a=0;a<n;a++)I.admins[a].id==t&&I.admins.splice(a,1);return localStorage.sAdmins=JSON.stringify(I),h(),!0}function i(){return null===localStorage.getItem("bAdmin")?(localStorage.bAdmin=!1,C=!1):(C=localStorage.bAdmin,"true"===C.toLowerCase()&&(C=!0)),C}function l(){null!==localStorage.getItem("sEvents")&&(D=JSON.parse(localStorage.sEvents))}function r(e){return l(),D.events.push(e),localStorage.sEvents=JSON.stringify(D),!0}function s(){null!==localStorage.getItem("sPartners")&&(L=JSON.parse(localStorage.sPartners))}function d(e){return s(),L.partners.push(e),localStorage.sPartners=JSON.stringify(L),!0}function o(e){s();for(var t=L.partners.length,n=0;n<t;n++)L.partners[n].id==e.id&&(L.partners[n]=e);return localStorage.sPartners=JSON.stringify(L),!0}function c(e){s();for(var t=L.partners.length,n=0;n<t;n++)L.partners[n].id==e&&L.partners.splice(n,1);return localStorage.sPartners=JSON.stringify(L),w(),!0}function m(t){var n=O(t).children("#lblAdminUsername").val(),a=O(t).children("#lblAdminPassword").val();e();for(var i=I.admins.length,l=0;l<i;l++){if(I.admins[l].username==n&&I.admins[l].password==a){localStorage.bAdmin=!0,h(),O(".wdw-admin-picker").fadeIn(),E||u(!0);break}localStorage.bAdmin=!1,E||u(!1)}O(t).children("#lblAdminUsername").val(""),O(t).children("#lblAdminPassword").val("")}function u(e){E=!0,e?(O("#lblAdminLogin span").text("Login successful.").fadeIn(),setTimeout(function(){O("#lblAdminLogin span").fadeOut(),E=!1,O(".wdw-login form").fadeOut(),setTimeout(function(){O(".admin-logout").fadeIn()},750)},1e3)):(O("#lblAdminLogin span").text("Login failed.").fadeIn(),setTimeout(function(){O("#lblAdminLogin span").fadeOut(),E=!0},1e3))}function p(n){var a=O(n).children("#lblAdminNewUsername").val(),i=O(n).children("#lblAdminNewPassword").val();e();var l={};l.id=A(),l.username=a,l.password=i,t(l),O(n).children("#lblAdminNewUsername").val(""),O(n).children("#lblAdminNewPassword").val(""),h()}function v(e){var t=O(e).find("#lblEventImage").val(),n=O(e).find("#lblEventTitle").val(),a=O(e).find("#lblEventOrganizer").val(),i=O(e).find("#lblEventDate").val(),s=O(e).find("#lblEventPrice").val(),d=O(e).find("#lblEventLocation").val(),o=O(e).find("#lblEventDescription").val();l();var c={};c.id=A(),c.img=t,c.title=n,c.organizer=a,c.date=i,c.price=s,c.location=d,c.partners="wat",c.description=o,r(c),O(e).children().val(""),g()}function f(e){var t=O(e).find("#lblPartnerImage").val(),n=O(e).find("#lblPartnerName").val(),a=O(e).find("#lblPartnerCEO").val(),i=O(e).find("#lblPartnerWebsite").val(),l=O(e).find("#lblPartnerHeadquarters").val(),r=O(e).find("#lblPartnerDescription").val();s();var o={};o.id=A(),o.img=t,o.ceo=a,o.website=i,o.headquarters=l,o.description=r,o.name=n,d(o),O(e).children().val(""),w()}function b(e){1==i()&&(O(".pick-window").css("display","none"),O(e).hasClass("admin-event-list")?(g(),O(".wdw-event-list").fadeIn()):O(e).hasClass("admin-partner-list")?(w(),O(".wdw-partner-list").fadeIn()):O(e).hasClass("admin-admin-list")&&(h(),O(".wdw-admin-list").fadeIn()))}function h(){var t="";e();for(var n=I.admins.length,a=0;a<n;a++)t+=x.replace("{{name}}",I.admins[a].username),t=t.replace("{{id}}",I.admins[a].id);O(".wdw-admin-list div").empty().append(t)}function g(){var e="";l();for(var t=D.events.length,n=0;n<t;n++)e+=J.replace("{{id}}",D.events[n].id),e=e.replace("{{img}}",D.events[n].img),e=e.replace("{{title}}",D.events[n].title),e=e.replace("{{organizer}}",D.events[n].organizer),e=e.replace("{{date}}",D.events[n].date),e=e.replace("{{price}}",D.events[n].price),e=e.replace("{{location}}",D.events[n].location),e=e.replace("{{partners}}",D.events[n].partners),e=e.replace("{{description}}",D.events[n].description);O(".wdw-event-list div.event-list").empty().append(e)}function w(){var e="";s();for(var t=L.partners.length,n=0;n<t;n++)e+=k.replace("{{id}}",L.partners[n].id),e=e.replace("{{img}}",L.partners[n].img),e=e.replace("{{name}}",L.partners[n].name),e=e.replace("{{ceo}}",L.partners[n].ceo),e=e.replace("{{website}}",L.partners[n].website),e=e.replace("{{headquarters}}",L.partners[n].headquarters),e=e.replace("{{description}}",L.partners[n].description);O(".wdw-partner-list div.partner-list").empty().append(e)}function y(e){if(O(e).hasClass("admin-list-item")){var t=O(e).children("h3:first-child").text();t=t.split(": "),t=t[1];var n=O(e).children("h3:nth-child(2)").text();n=n.split(": "),n=n[1];var a="";a+=N.replace("{{name}}",t).replace("{{id}}",n),O("#modal-top h2").empty().text("Edit Admin: "+t),O("#modal-middle").empty().append(a),O("#wdw-admin-modal").fadeIn()}if(O(e).hasClass("lblPartnerCreate")){var n=O(e).find(".lblPartnerId").val(),i=O(e).find(".lblPartnerImage").val(),t=O(e).find(".lblPartnerName").val(),l=O(e).find(".lblPartnerCEO").val(),r=O(e).find(".lblPartnerWebsite").val(),s=O(e).find(".lblPartnerHeadquarters").val(),d=O(e).find(".lblPartnerDescription").val(),c={};c.id=n,c.img=i,c.ceo=l,c.website=r,c.headquarters=s,c.description=d,c.name=t,o(c),O(e).populatePartnerList()}}function S(e){if(O(e).hasClass("admin-list-item")){var t=O(e).children("h3:nth-child(2)").text();t=t.split(": "),t=t[1],console.log(t),swal({title:"Are you sure?",text:"You will not be able to recover this admin user!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){swal("Deleted!","The admin user has been deleted.","success"),a(t)})}if(O(e).hasClass("partner-item")){var t=O(e).find('input[type="hidden"]').val();console.log(t),swal({title:"Are you sure?",text:"You will not be able to recover this admin user!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){swal("Deleted!","The admin user has been deleted.","success"),c(t)})}}function P(t){var a=O(t).children("input:first-child").val(),i=O(t).children("input:nth-child(2)").val(),l={};e();for(var r=I.admins.length,s=0;s<r;s++)I.admins[s].id==i&&(l=I.admins[s]);l.username=a,l.id=i,n(l),h(),O("#wdw-admin-modal").fadeOut()}function A(){var e="";return e=(Math.random().toString(16)+"000000000").substr(2,8),e+=O.now().toString()}var O=jQuery.noConflict();console.log("Page loaded and ready.");var C,I={admins:[]},E=!1,x='<div class="admin-list-item"><h3>Name: {{name}}</h3><h3>ID: {{id}}</h3><i class="fa fa-pencil edit-item" aria-hidden="true"></i><i class="fa fa-trash-o delete-item" aria-hidden="true"></i></div>',N='<div class="modal-admin-edit-form-container"><form><input type="text" placeholder="Name..." value="{{name}}"><input type="text" placeholder="ID..." value="{{id}}"><input type="submit" value="SUBMIT"></form></div>',D={events:[]},J='<div class="event-item round-corners"><form class="lblEventCreate"><div><input class="lblEventImage" type="text" value="{{img}}"></div><div><div><input class="lblEventTitle" type="text" value="{{title}}"><input class="lblEventOrganizer" type="text" value="{{organizer}}"><input class="lblEventDate" type="date" value="{{date}}"><input class="lblEventPrice" type="text" value="{{price}}"><input class="lblEventLocation" type="text" value="{{location}}"><a href="#">{{partners}}</a><input type="submit" class="btnEventCreate" value="CREATE"></div><div><textarea class="lblEventDescription">{{description}}</textarea></div></div><input class="lblEventId" type="hidden" value="{{id}}"></form><i class="fa fa-trash-o delete-item" aria-hidden="true"></i></div>',L={partners:[]},k='<div class="partner-item round-corners"><form class="lblPartnerCreate"><div><input class="lblPartnerImage" type="text" value="{{img}}"></div><div><div><input class="lblPartnerName" type="text" value="{{name}}"><input class="lblPartnerCEO" type="text" value="{{ceo}}"><input class="lblPartnerWebsite" type="text" value="{{website}}"><input class="lblPartnerHeadquarters" type="text" value="{{headquarters}}"><input class="btnPartnerCreate" type="submit" value="SUBMIT"></div><div><textarea class="lblPartnerDescription">{{description}}</textarea></div></div><input class="lblPartnerId" type="hidden" value="{{id}}"></form><i class="fa fa-trash-o delete-item" aria-hidden="true"></i></div>';!function(){if(null===localStorage.getItem("sAdmins")){var e={id:A(),username:"admin",password:"admin"};I.admins.push(e),localStorage.sAdmins=JSON.stringify(I)}else I=JSON.parse(localStorage.sAdmins)}(),O("#lblAdminLogin").submit(function(e){e.preventDefault(),m(this)}),O("#lblAdminCreate").submit(function(e){e.preventDefault(),p(this)}),O("#lblEventCreate").submit(function(e){e.preventDefault(),v(this)}),O("#lblPartnerCreate").submit(function(e){e.preventDefault(),f(this)}),O(".wdw-admin-picker ul li a").click(function(){b(this)}),O(document).on("click",".admin-list-item .edit-item",function(){y(O(this).parent())}),O(document).on("submit",".lblPartnerCreate",function(){y(this)}),O(document).on("click",".delete-item",function(){S(O(this).parent())}),O(document).on("click",'.modal-admin-edit-form-container form input[type="submit"]',function(e){e.preventDefault(),P(O(this).parent())}),O(".admin-logout").click(function(){localStorage.bAdmin=!1}),setInterval(function(){1==i()?(O(".wdw-admin-picker").fadeIn(),O("#lblAdminLogin").fadeOut(),O(".admin-logout").fadeIn()):(O(".wdw-admin-picker").fadeOut(),O(".pick-window").fadeOut(),O(".admin-logout").fadeOut(),O("#lblAdminLogin").fadeIn())},500)});